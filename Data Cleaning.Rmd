---
title: "Preci"
author: "Bobby Drysdale"
date: "10/19/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(readxl)
library(janitor)
library(reshape2)
```

```{r}
#First I examined Gordan Hayward's season statistics by year.
##I read in this data from Basketball Reference

haywardstats <- read_excel("gordanhaywardstats.xlsx")

#I get rid of his career totals and clean the variable names
ghperseason <- haywardstats %>% 
  head(n = 9) %>% clean_names()

#To make predictions on what he would have done if he didnt get hurt. We need his totals from the years he was at the jazz

ghtotals <- read_excel("ghtotals.xlsx")

#To predict thge kind of year Gordan Hayward would have had, I use the Simple Projection System (SPS) to calculate it.
## More info in this system can be found here: https://www.basketball-reference.com/about/projections.html

ghnoinjury <- ghtotals %>%
  clean_names() %>% 
  
  #We only need the last three years before he got hurt to preform the prediciton
  
  slice(5:7) %>% 
  
  #Removing unneeded variables
  select(-age, -tm, -lg, -g, -gs, -pos)

  #Creating a dataframe to merge with my dataframe in order to calculate predicted totals using spefific weights for each of the previous seasons

preweight <- data.frame(season = c("2014-15", "2015-16", "2016-17"), weights = c(6,3,1))

#I Merge the two datasets together
ghpredict <- merge(ghnoinjury, preweight)

#Giving the following weights to all of his total stats: 2016-17 6 times multiplier, 2015-16 3 times multiplier and 2014-15 a 1 times multiplier

ghpredict <-  ghpredict[, 2:24] * ghpredict[, 25]

#I them add the three seasons together
ghpredict <- ghpredict %>% 
  adorn_totals()

#I take only the total values
ghpredict <- ghpredict %>% 
  slice(4)

ghpredict$mp <- 26903
  
  

#The next step is to calculate a league average players stats playing the amount of minuetes as Hayward

#First I read in Leaguewide averaged from each year and select the years I need

leagueavg <- read_excel("leaguewide_averages.xlsx", skip = 1) %>%
  slice(3:5) %>% 
  clean_names() %>% 
  select(-rk, -season, -lg, -ht, -wt, -age, -g, -pace, -e_fg_percent, -tov_percent, -orb_percent, -ft_fga, -o_rtg)

# Dividing all the average statisitcs by minuetes played then multiplying by both the season weights we used before and Gordan Haywards Minutes

lgavgmin <- leagueavg %>% 
  select(mp)

leagueavg1 <- leagueavg / lgavgmin$mp

leagueavg1 <- leagueavg1 * preweight$weights

leagueavg1 <- leagueavg1 * ghnoinjury$mp

#I take the total from the three years

leagueavg1 <- leagueavg1 %>% 
  adorn_totals() %>% 
  slice(4)

leagueavg1$mp <- 26903

#Now we scale this figure to 1000 minuetes
##The 26,903 is the weighted total amount of minutes from Gordan Haywards three years prior to injury

leagueavg1 <- (leagueavg1 / 26903) * 1000

#I now calculate Hayward's projected per-36 minuete value
##This is what he would average if he played 36 minuetes per game. It is the regarded as the standard measure in a basketball game for a starter

gordanfinalpred <- (ghpredict + leagueavg1)
```

